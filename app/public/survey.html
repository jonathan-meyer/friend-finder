<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Survey</title>
    <link rel="stylesheet" href="/bootstrap/dist/css/bootstrap.css" />
    <script src="/jquery/dist/jquery.js"></script>
    <script src="/bootstrap/dist/js/bootstrap.js"></script>
    <script>
      $(function() {
        $("form").on("submit", function(e) {
          e.preventDefault();
          console.log($(this).serializeArray());
        });

        $.get("/api/questions")
          .then(data =>
            data.map(function(q) {
              $("#questions")
                .addClass("")
                .append(
                  $("<div>")
                    .addClass("card mb-3")
                    .append(
                      $("<div>")
                        .addClass("card-header")
                        .append(
                          $("<label>")
                            .attr({ for: `question_${q.id}` })
                            .text(q.text)
                        ),
                      $("<div>")
                        .addClass("card-body")
                        .append(
                          $("<datalist>")
                            .attr({ id: `${q.id}_ticks` })
                            .css({
                              display: "flex",
                              justifyContent: "space-between"
                            })
                            .append(
                              new Array(5)
                                .fill(0)
                                .map((v, i) => i + 1)
                                .map(function(v) {
                                  return $("<option>")
                                    .attr({
                                      value: v,
                                      label:
                                        v === 1
                                          ? "Strongly Disagree"
                                          : v === 5
                                          ? "Strongly Agree"
                                          : ""
                                    })
                                    .css({ fontSize: "x-small" });
                                })
                            ),
                          $("<input>")
                            .addClass("form-control-range")
                            .attr({
                              type: "range",
                              list: `${q.id}_ticks`,
                              id: `question_${q.id}`,
                              name: `question_${q.id}`,
                              min: 1,
                              max: 5,
                              value: 3
                            })
                        )
                    )
                );
            })
          )
          .catch(err => console.error(err));
      });
    </script>
  </head>
  <body>
    <div class="container p-3">
      <div class="card">
        <div class="card-header">
          <h3>Survey</h3>
        </div>

        <div class="card-body">
          <form>
            <div id="questions"></div>
            <input type="submit" class="btn btn-outline-primary" />
          </form>
        </div>

        <div class="card-footer"></div>
      </div>
    </div>
  </body>
</html>
